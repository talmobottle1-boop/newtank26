<DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OXBIT | Professional Crypto DEX</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM CDN -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { 
            font-family: 'Inter', sans-serif; 
            -webkit-tap-highlight-color: transparent;
        }
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 10px; }
        
        /* Mobile Chart Height Adjustment */
        @media (max-width: 768px) {
            .tradingview-container { height: 400px !important; }
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 antialiased overflow-x-hidden">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        const { 
            ArrowUpRight, ArrowDownRight, Wallet, Activity, Settings, 
            ChevronDown, Menu, X, Lock, Zap, ShieldCheck, Globe, 
            TrendingUp, BarChart3, Share2, Download, Copy, LayoutGrid, Repeat
        } = lucide;

        const App = () => {
            const [leverage, setLeverage] = useState(10);
            const [isWalletConnected, setIsWalletConnected] = useState(false);
            const [activeTab, setActiveTab] = useState('long');
            const [btcPrice, setBtcPrice] = useState(0);
            const [priceChange, setPriceChange] = useState(0);
            const [high24h, setHigh24h] = useState(0);
            const [low24h, setLow24h] = useState(0);
            const [volume24h, setVolume24h] = useState(0);
            const [connectionStatus, setConnectionStatus] = useState('connecting');
            const [showPnlCard, setShowPnlCard] = useState(false);
            const [mobileNav, setMobileNav] = useState('trade');

            const entryPrice = 64100.00;
            const positionSide = 'long';

            useEffect(() => {
                let ws;
                const connectWS = () => {
                    ws = new WebSocket('wss://stream.binance.com:9443/ws/btcusdt@ticker');
                    ws.onopen = () => setConnectionStatus('connected');
                    ws.onmessage = (event) => {
                        const data = JSON.parse(event.data);
                        setBtcPrice(parseFloat(data.c));
                        setPriceChange(parseFloat(data.P));
                        setHigh24h(parseFloat(data.h));
                        setLow24h(parseFloat(data.l));
                        setVolume24h(parseFloat(data.q));
                    };
                    ws.onclose = () => {
                        setConnectionStatus('disconnected');
                        setTimeout(connectWS, 3000);
                    };
                };
                connectWS();
                return () => ws && ws.close();
            }, []);

            useEffect(() => {
                if (typeof lucide !== 'undefined') {
                    lucide.createIcons();
                }
            }, [btcPrice, showPnlCard, mobileNav]);

            const pnlData = useMemo(() => {
                if (!btcPrice) return { uPnl: 0, roe: 0 };
                const diff = btcPrice - entryPrice;
                const uPnl = positionSide === 'long' ? diff * 0.5 : -diff * 0.5;
                const roe = (uPnl / (entryPrice * 0.5 / 10)) * 100;
                return { uPnl, roe };
            }, [btcPrice]);

            const calculateLiqPrice = (price, lev, side) => {
                if (!price || price <= 0) return 0;
                return side === 'long' ? price * (1 - 1 / lev) : price * (1 + 1 / lev);
            };

            const currentLiqPrice = useMemo(() => calculateLiqPrice(entryPrice, 10, positionSide), []);
            const estimatedLiqPrice = useMemo(() => calculateLiqPrice(btcPrice, leverage, activeTab), [btcPrice, leverage, activeTab]);

            const orderBookData = useMemo(() => {
                if (btcPrice === 0) return { asks: [], bids: [] };
                const asks = [], bids = [];
                for (let i = 5; i >= 1; i--) asks.push({ price: btcPrice + (i * 0.5), amount: (Math.random() * 0.5 + 0.1).toFixed(3) });
                for (let i = 1; i <= 5; i++) bids.push({ price: btcPrice - (i * 0.5), amount: (Math.random() * 0.8 + 0.2).toFixed(3) });
                return { asks, bids };
            }, [btcPrice]);

            const OxbitLogo = ({ small = false }) => (
                <div className="flex items-center gap-2">
                    <div className={`${small ? 'p-0.5' : 'p-1'} bg-slate-900 rounded-lg shadow-lg shadow-sky-100`}>
                        <div className={`grid grid-cols-3 gap-0.5`}>
                            {[...Array(9)].map((_, i) => (
                                <div key={i} className={`${small ? 'w-1.5 h-1.5' : 'w-2 h-2'} rounded-sm ${i === 4 ? 'bg-white shadow-[0_0_8px_#38bdf8]' : 'bg-sky-500 opacity-60'}`}></div>
                            ))}
                        </div>
                    </div>
                    {!small && (
                        <span className="text-xl font-black tracking-tighter text-slate-900">
                            OX<span className="text-sky-500">BIT</span>
                        </span>
                    )}
                </div>
            );

            if (btcPrice === 0) return (
                <div className="min-h-screen flex flex-col items-center justify-center bg-white p-6 text-center">
                    <div className="w-16 h-16 bg-sky-50 rounded-3xl flex items-center justify-center mb-6 animate-pulse">
                        <i data-lucide="activity" className="text-sky-500 w-8 h-8"></i>
                    </div>
                    <h1 className="text-xl font-black text-slate-900 mb-2">데이터 로딩 중...</h1>
                    <p className="text-sm font-medium text-slate-400">Binance 클라우드와 보안 연결을 시도하고 있습니다.</p>
                </div>
            );

            return (
                <div className="min-h-screen pb-24 md:pb-16 bg-slate-50">
                    {/* PnL Card Modal */}
                    {showPnlCard && (
                        <div className="fixed inset-0 z-[100] flex items-end md:items-center justify-center bg-slate-900/80 backdrop-blur-md p-0 md:p-4">
                            <div className="bg-white rounded-t-[40px] md:rounded-[40px] overflow-hidden shadow-2xl max-w-sm w-full relative transform transition-transform animate-in slide-in-from-bottom duration-300">
                                <button onClick={() => setShowPnlCard(false)} className="absolute top-6 right-6 p-2 bg-white/20 hover:bg-white/40 rounded-full text-white z-20">
                                    <i data-lucide="x"></i>
                                </button>
                                <div className="p-8 bg-slate-900 text-white relative overflow-hidden">
                                    <div className="absolute top-0 right-0 w-64 h-64 bg-sky-500/20 blur-[80px] -mr-32 -mt-32"></div>
                                    <div className="relative z-10">
                                        <div className="flex justify-between items-start mb-12"><OxbitLogo /><div className="text-right text-[10px] font-black"><div className="text-sky-400 uppercase tracking-widest">Binance Live</div><div className="text-slate-400">BTCUSDT Perpetual</div></div></div>
                                        <div className="mb-10">
                                            <div className={`text-6xl font-black tracking-tighter ${pnlData.roe >= 0 ? 'text-emerald-400' : 'text-rose-400'}`}>{pnlData.roe >= 0 ? '+' : ''}{pnlData.roe.toFixed(2)}%</div>
                                            <div className="text-xs font-bold text-slate-400 mt-3 flex items-center gap-2"><span className="px-2 py-0.5 bg-slate-800 rounded text-sky-400">10x</span><span>Isolated Long</span></div>
                                        </div>
                                        <div className="grid grid-cols-2 gap-8 border-t border-white/10 pt-8">
                                            <div><div className="text-[10px] font-black text-slate-500 uppercase mb-1">진입 가격</div><div className="font-mono font-bold text-lg">${entryPrice.toLocaleString()}</div></div>
                                            <div className="text-right"><div className="text-[10px] font-black text-slate-500 uppercase mb-1">현재 가격</div><div className="font-mono font-bold text-sky-400 text-lg">${btcPrice.toLocaleString()}</div></div>
                                        </div>
                                    </div>
                                </div>
                                <div className="p-6 pb-10 md:pb-6 flex gap-3">
                                    <button className="flex-1 py-4 bg-sky-500 text-white rounded-2xl font-black text-sm flex items-center justify-center gap-2 hover:shadow-lg transition-all active:scale-95"><i data-lucide="download" className="w-4 h-4"></i> 이미지 저장</button>
                                    <button className="p-4 bg-slate-100 text-slate-600 rounded-2xl active:bg-slate-200"><i data-lucide="copy" className="w-5 h-5"></i></button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Desktop Header & Mobile Ticker */}
                    <div className="bg-slate-900 text-white py-2 px-4 md:px-6 border-b border-sky-900/30 flex items-center justify-between overflow-hidden">
                        <div className="flex gap-4 md:gap-8 items-center">
                            <div className="flex gap-2 items-center">
                                <span className="font-black text-sky-400 text-xs md:text-sm">BTC</span>
                                <span className="font-mono text-sm md:text-base font-bold">${btcPrice.toLocaleString(undefined, { minimumFractionDigits: 1 })}</span>
                                <span className={`text-xs font-bold ${priceChange >= 0 ? 'text-emerald-400' : 'text-rose-400'}`}>{priceChange >= 0 ? '+' : ''}{priceChange.toFixed(2)}%</span>
                            </div>
                            <div className="hidden md:flex gap-4 items-center opacity-60 border-l border-white/10 pl-8 font-mono text-[11px]">
                                <span>High: ${high24h.toLocaleString()}</span>
                                <span>Low: ${low24h.toLocaleString()}</span>
                            </div>
                        </div>
                        <div className="text-[10px] font-black text-sky-500 uppercase tracking-widest animate-pulse">Live</div>
                    </div>

                    {/* Nav */}
                    <nav className="sticky top-0 z-50 bg-white/90 backdrop-blur-xl border-b border-slate-100 px-4 md:px-6 h-14 md:h-16 flex justify-between items-center">
                        <OxbitLogo />
                        <div className="flex items-center gap-3">
                            <button onClick={() => setIsWalletConnected(!isWalletConnected)} className={`px-4 md:px-6 py-2 md:py-2.5 rounded-xl md:rounded-2xl font-black text-[11px] md:text-sm transition-all flex items-center gap-2 ${isWalletConnected ? 'bg-slate-100 text-slate-600' : 'bg-sky-500 text-white shadow-lg shadow-sky-100'}`}>
                                <i data-lucide="wallet" className="w-3 h-3 md:w-4 md:h-4"></i>
                                {isWalletConnected ? '0x71...4f2' : '지갑 연결'}
                            </button>
                        </div>
                    </nav>

                    <main className="max-w-[1800px] mx-auto p-4 md:p-6 grid grid-cols-12 gap-4 md:gap-6">
                        {/* Mobile Navigation Tabs (Only Visible on Mobile) */}
                        <div className="col-span-12 md:hidden flex bg-white p-1 rounded-2xl border border-slate-100 shadow-sm">
                            <button onClick={() => setMobileNav('trade')} className={`flex-1 py-3 rounded-xl text-xs font-black transition-all ${mobileNav === 'trade' ? 'bg-slate-900 text-white' : 'text-slate-400'}`}>트레이딩</button>
                            <button onClick={() => setMobileNav('info')} className={`flex-1 py-3 rounded-xl text-xs font-black transition-all ${mobileNav === 'info' ? 'bg-slate-900 text-white' : 'text-slate-400'}`}>시장 정보</button>
                        </div>

                        {/* Left Content (Chart & Table) */}
                        <div className={`col-span-12 lg:col-span-9 space-y-4 md:space-y-6 ${mobileNav !== 'trade' ? 'hidden md:block' : ''}`}>
                            {/* Chart */}
                            <div className="bg-white rounded-[32px] md:rounded-[40px] border border-slate-100 shadow-sm overflow-hidden relative tradingview-container h-[350px] md:h-auto md:aspect-[21/10]">
                                <iframe id="tradingview_btc_usdt" title="Binance Chart" src={`https://www.tradingview.com/widgetembed/?symbol=BINANCE:BTCUSDT&interval=1&hidesidetoolbar=1&symboledit=0&saveimage=1&toolbarbg=ffffff&theme=light&style=1&timezone=Asia%2FSeoul&withdateranges=1&showpopupbutton=1&locale=kr`} width="100%" height="100%" frameBorder="0" scrolling="no" className="absolute inset-0"></iframe>
                            </div>

                            {/* Position Card / Mobile Optimized */}
                            <div className="bg-white rounded-[32px] border border-slate-100 shadow-sm overflow-hidden">
                                <div className="px-6 py-4 border-b border-slate-50 flex items-center justify-between">
                                    <h3 className="font-black text-sm text-slate-900">내 포지션 <span className="text-sky-500 ml-1">1</span></h3>
                                    <button onClick={() => setShowPnlCard(true)} className="md:hidden p-2 bg-sky-50 text-sky-600 rounded-lg"><i data-lucide="share-2" className="w-4 h-4"></i></button>
                                </div>
                                <div className="p-4 md:p-8">
                                    {/* Desktop Table */}
                                    <div className="hidden md:block overflow-x-auto">
                                        <table className="w-full text-left">
                                            <thead><tr className="text-[10px] font-black text-slate-400 uppercase tracking-widest"><th className="pb-6">자산/사이드</th><th className="pb-6 text-right">진입가</th><th className="pb-6 text-right">청산가</th><th className="pb-6 text-right">손익(ROE)</th><th className="pb-6"></th></tr></thead>
                                            <tbody>
                                                <tr className="text-sm font-bold border-t border-slate-50">
                                                    <td className="py-6"><span className="text-sky-500 font-black">BTC Long</span><span className="ml-2 bg-sky-50 text-sky-600 text-[10px] px-1.5 py-0.5 rounded">10x</span></td>
                                                    <td className="py-6 text-right font-mono">${entryPrice.toLocaleString()}</td>
                                                    <td className="py-6 text-right font-mono text-rose-500">${currentLiqPrice.toLocaleString(undefined, { minimumFractionDigits: 1 })}</td>
                                                    <td className="py-6 text-right"><div className={`flex flex-col items-end ${pnlData.roe >= 0 ? 'text-emerald-500' : 'text-rose-500'}`}><span>${pnlData.uPnl.toFixed(2)}</span><span className="text-[11px] font-medium">({pnlData.roe.toFixed(2)}%)</span></div></td>
                                                    <td className="py-6 text-right"><button onClick={() => setShowPnlCard(true)} className="hidden lg:inline-flex p-2.5 bg-sky-50 text-sky-600 rounded-xl hover:bg-sky-500 hover:text-white transition-all"><i data-lucide="share-2" className="w-4 h-4"></i></button></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    {/* Mobile Card */}
                                    <div className="md:hidden space-y-4">
                                        <div className="flex justify-between items-start">
                                            <div className="flex items-center gap-2"><span className="font-black text-sky-500 text-lg">BTC Long</span><span className="bg-sky-50 text-sky-600 text-[10px] px-2 py-0.5 rounded-full font-bold">10x</span></div>
                                            <div className={`text-right font-black ${pnlData.roe >= 0 ? 'text-emerald-500' : 'text-rose-500'}`}>
                                                <div className="text-lg">{pnlData.roe >= 0 ? '+' : ''}{pnlData.roe.toFixed(2)}%</div>
                                                <div className="text-[11px] opacity-70">${pnlData.uPnl.toFixed(2)}</div>
                                            </div>
                                        </div>
                                        <div className="grid grid-cols-2 gap-4 bg-slate-50 p-4 rounded-2xl">
                                            <div><div className="text-[10px] font-black text-slate-400 uppercase mb-1">진입가</div><div className="font-mono font-bold text-sm">${entryPrice.toLocaleString()}</div></div>
                                            <div><div className="text-[10px] font-black text-slate-400 uppercase mb-1">청산가</div><div className="font-mono font-bold text-sm text-rose-500">${currentLiqPrice.toLocaleString(undefined, { minimumFractionDigits: 1 })}</div></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Right Content (Orderbook & Trade) */}
                        <div className={`col-span-12 lg:col-span-3 space-y-4 md:space-y-6 ${mobileNav === 'trade' ? 'hidden md:block' : ''}`}>
                            {/* Orderbook Card */}
                            <div className="bg-white rounded-[32px] p-5 border border-slate-100 shadow-sm">
                                <h3 className="text-[10px] font-black text-slate-400 mb-4 uppercase tracking-widest flex items-center justify-between">
                                    <span>실시간 호가</span>
                                    <span className="text-sky-500 animate-pulse">● Live</span>
                                </h3>
                                <div className="space-y-1 font-mono text-[11px] font-bold">
                                    {orderBookData.asks.map((item, i) => (
                                        <div key={`ask-${i}`} className="flex justify-between text-rose-500 px-2 py-1">
                                            <span>{item.price.toLocaleString(undefined, { minimumFractionDigits: 1 })}</span>
                                            <span className="text-slate-300 font-medium">{item.amount}</span>
                                        </div>
                                    ))}
                                    <div className="py-4 my-1 text-center bg-slate-900 rounded-xl text-white">
                                        <div className="text-xl font-black">${btcPrice.toLocaleString(undefined, { minimumFractionDigits: 1 })}</div>
                                    </div>
                                    {orderBookData.bids.map((item, i) => (
                                        <div key={`bid-${i}`} className="flex justify-between text-sky-500 px-2 py-1">
                                            <span>{item.price.toLocaleString(undefined, { minimumFractionDigits: 1 })}</span>
                                            <span className="text-slate-300 font-medium">{item.amount}</span>
                                        </div>
                                    ))}
                                </div>
                            </div>

                            {/* Trade Panel */}
                            <div className="bg-white rounded-[32px] p-6 border border-slate-100 shadow-xl shadow-sky-100/30">
                                <div className="flex bg-slate-100 p-1 rounded-2xl mb-6">
                                    <button onClick={() => setActiveTab('long')} className={`flex-1 py-3 rounded-xl font-black text-xs transition-all ${activeTab === 'long' ? 'bg-sky-500 text-white shadow-md' : 'text-slate-400'}`}>Long</button>
                                    <button onClick={() => setActiveTab('short')} className={`flex-1 py-3 rounded-xl font-black text-xs transition-all ${activeTab === 'short' ? 'bg-slate-900 text-white shadow-md' : 'text-slate-400'}`}>Short</button>
                                </div>
                                <div className="space-y-5">
                                    <div>
                                        <div className="flex justify-between mb-3 text-[11px] font-black text-slate-400">레버리지 <span className="text-sky-500">{leverage}x</span></div>
                                        <input type="range" min="1" max="100" value={leverage} onChange={(e) => setLeverage(Number(e.target.value))} className="w-full h-1.5 bg-slate-100 rounded-full appearance-none accent-sky-500 cursor-pointer" />
                                    </div>
                                    <div className="bg-slate-50 rounded-2xl p-4 border border-transparent focus-within:border-sky-200 transition-all">
                                        <div className="text-[10px] font-black text-slate-400 mb-1 uppercase">주문 수량 (BTC)</div>
                                        <input type="number" placeholder="0.00" className="bg-transparent text-xl font-black outline-none w-full" />
                                    </div>
                                    <div className="bg-sky-50/50 rounded-2xl p-4 flex justify-between items-center text-[11px] font-bold">
                                        <span className="text-slate-500">예상 청산가</span>
                                        <span className="font-mono font-black text-rose-500">${estimatedLiqPrice.toLocaleString(undefined, { minimumFractionDigits: 1 })}</span>
                                    </div>
                                    <button className={`w-full py-4 rounded-2xl font-black text-sm shadow-lg transition-all active:scale-95 ${activeTab === 'long' ? 'bg-sky-500 text-white' : 'bg-slate-900 text-white'}`}>
                                        {isWalletConnected ? `${activeTab === 'long' ? '매수' : '매도'} 포지션 오픈` : '지갑 연결 필요'}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </main>

                    {/* Mobile Footer Navigation (Fixed) */}
                    <div className="md:hidden fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-xl border-t border-slate-100 grid grid-cols-4 px-2 py-3 z-50">
                        <button onClick={() => setMobileNav('trade')} className={`flex flex-col items-center gap-1 ${mobileNav === 'trade' ? 'text-sky-500' : 'text-slate-400'}`}>
                            <i data-lucide="trending-up" className="w-5 h-5"></i>
                            <span className="text-[9px] font-black">트레이딩</span>
                        </button>
                        <button onClick={() => setMobileNav('info')} className={`flex flex-col items-center gap-1 ${mobileNav === 'info' ? 'text-sky-500' : 'text-slate-400'}`}>
                            <i data-lucide="bar-chart-3" className="w-5 h-5"></i>
                            <span className="text-[9px] font-black">차트정보</span>
                        </button>
                        <button className="flex flex-col items-center gap-1 text-slate-400">
                            <i data-lucide="repeat" className="w-5 h-5"></i>
                            <span className="text-[9px] font-black">자산현황</span>
                        </button>
                        <button className="flex flex-col items-center gap-1 text-slate-400">
                            <i data-lucide="settings" className="w-5 h-5"></i>
                            <span className="text-[9px] font-black">설정</span>
                        </button>
                    </div>

                    {/* Desktop Footer Only */}
                    <footer className="fixed bottom-0 w-full bg-white/90 backdrop-blur-md border-t border-slate-100 py-3 px-8 hidden md:flex justify-between items-center z-[40]">
                        <div className="flex items-center gap-6">
                            <div className="flex items-center gap-2 px-3 py-1 bg-sky-50 rounded-full border border-sky-100">
                                <div className="w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"></div>
                                <span className="text-[9px] font-black text-slate-600">BINANCE CLOUD CONNECTED</span>
                            </div>
                            <div className="text-[10px] font-bold text-slate-400">24h Vol: ${(volume24h/1e6).toFixed(2)}M USDT</div>
                        </div>
                        <div className="text-[10px] font-black text-slate-400 uppercase tracking-widest">{new Date().toLocaleTimeString()} (KST)</div>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
