<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OXBIT | Professional Crypto DEX</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <!-- React & ReactDOM CDN -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
        body { 
            font-family: 'Inter', sans-serif; 
            -webkit-tap-highlight-color: transparent;
        }
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 4px; height: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 10px; }
        .dark ::-webkit-scrollbar-thumb { background: #334155; }
        
        .transition-all { transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); }

        /* Range input styling */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: #0ea5e9;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 0 8px rgba(14, 165, 233, 0.3);
        }
        
        /* Fixed Aspect Ratio for Chart */
        .chart-container {
            position: relative;
            width: 100%;
            padding-top: 45%; /* Default for desktop */
        }
        @media (max-width: 768px) {
            .chart-container { padding-top: 85%; }
        }
    </style>
</head>
<body class="text-slate-800 dark:text-slate-200 antialiased overflow-x-hidden bg-slate-50 dark:bg-slate-950 transition-colors duration-300">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;
        const { 
            Wallet, Settings, TrendingUp, BarChart3, Share2, Info, MoreHorizontal, X, ArrowDown, ArrowUp, Sun, Moon
        } = lucide;

        // Sound URLs (Using clear, high-quality notification sounds)
        const OPEN_SOUND = "https://assets.mixkit.co/active_storage/sfx/2358/2358-preview.mp3"; // iOS-like notification
        const CLOSE_SOUND = "https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3"; // Clean pop/click

        const App = () => {
            const [leverage, setLeverage] = useState(10);
            const [isWalletConnected, setIsWalletConnected] = useState(false);
            const [activeTab, setActiveTab] = useState('long'); // long or short
            const [btcPrice, setBtcPrice] = useState(0);
            const [priceChange, setPriceChange] = useState(0);
            const [high24h, setHigh24h] = useState(0);
            const [low24h, setLow24h] = useState(0);
            const [volume24h, setVolume24h] = useState(0);
            const [showPnlCard, setShowPnlCard] = useState(null); 
            const [mobileNav, setMobileNav] = useState('trade');
            const [isDark, setIsDark] = useState(false);
            const [orderAmount, setOrderAmount] = useState('');
            const [positions, setPositions] = useState([]);

            // Audio objects
            const openAudio = useRef(new Audio(OPEN_SOUND));
            const closeAudio = useRef(new Audio(CLOSE_SOUND));

            // Dark Mode Toggle Logic
            useEffect(() => {
                if (isDark) {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
            }, [isDark]);

            // WebSocket Connection
            useEffect(() => {
                let ws;
                let timeoutId;

                const connectWS = () => {
                    try {
                        ws = new WebSocket('wss://stream.binance.com:9443/ws/btcusdt@ticker');
                        ws.onmessage = (event) => {
                            const data = JSON.parse(event.data);
                            setBtcPrice(parseFloat(data.c));
                            setPriceChange(parseFloat(data.P));
                            setHigh24h(parseFloat(data.h));
                            setLow24h(parseFloat(data.l));
                            setVolume24h(parseFloat(data.q));
                        };
                        ws.onerror = (err) => console.error("WS Error:", err);
                        ws.onclose = () => {
                            timeoutId = setTimeout(connectWS, 3000);
                        };
                    } catch (e) {
                        console.error("Connection failed:", e);
                    }
                };

                connectWS();
                return () => {
                    if (ws) ws.close();
                    if (timeoutId) clearTimeout(timeoutId);
                };
            }, []);

            // Lucide icons Refresh Logic
            useEffect(() => {
                const timer = setTimeout(() => {
                    if (typeof lucide !== 'undefined') {
                        lucide.createIcons();
                    }
                }, 100);
                return () => clearTimeout(timer);
            }, [btcPrice, showPnlCard, mobileNav, isDark, positions]);

            // Play sound helper
            const playSound = (type) => {
                try {
                    const audio = type === 'open' ? openAudio.current : closeAudio.current;
                    audio.currentTime = 0;
                    audio.play().catch(e => console.log("Audio play blocked by browser policy"));
                } catch (e) {
                    console.error("Sound play error", e);
                }
            };

            // Trade Execution Logic
            const openPosition = () => {
                const amount = parseFloat(orderAmount);
                if (!amount || amount <= 0) return;

                const newPosition = {
                    id: Date.now(),
                    symbol: 'BTC/USDT',
                    side: activeTab,
                    leverage: leverage,
                    entryPrice: btcPrice,
                    amount: amount,
                    size: (amount * leverage) / btcPrice,
                    timestamp: new Date()
                };

                setPositions([newPosition, ...positions]);
                setOrderAmount('');
                playSound('open');
            };

            const closePosition = (id) => {
                setPositions(positions.filter(p => p.id !== id));
                playSound('close');
            };

            // Calculated data for order book
            const orderBookData = useMemo(() => {
                if (btcPrice === 0) return { asks: [], bids: [] };
                const asks = [], bids = [];
                for (let i = 6; i >= 1; i--) asks.push({ price: btcPrice + (i * 0.5), amount: (Math.random() * 0.5 + 0.1).toFixed(3) });
                for (let i = 1; i <= 6; i++) bids.push({ price: btcPrice - (i * 0.5), amount: (Math.random() * 0.8 + 0.2).toFixed(3) });
                return { asks, bids };
            }, [btcPrice]);

            const OxbitLogo = ({ small = false }) => (
                <div className="flex items-center gap-2">
                    <div className={`${small ? 'p-1' : 'p-1.5'} bg-sky-500 rounded-lg shadow-md shadow-sky-100 dark:shadow-none`}>
                        <div className="grid grid-cols-3 gap-0.5">
                            {[...Array(9)].map((_, i) => (
                                <div key={i} className={`${small ? 'w-1 h-1' : 'w-1.5 h-1.5'} rounded-full ${i === 4 ? 'bg-white' : 'bg-white opacity-40'}`}></div>
                            ))}
                        </div>
                    </div>
                    {!small && (
                        <span className="text-lg font-black tracking-tighter text-slate-900 dark:text-white">
                            OX<span className="text-sky-500">BIT</span>
                        </span>
                    )}
                </div>
            );

            // Calculate live PnL for each position
            const getLivePnL = (pos) => {
                const diff = btcPrice - pos.entryPrice;
                const uPnl = pos.side === 'long' ? diff * pos.size : -diff * pos.size;
                const roe = (uPnl / pos.amount) * 100;
                const liqPrice = pos.side === 'long' 
                    ? pos.entryPrice * (1 - 1/pos.leverage)
                    : pos.entryPrice * (1 + 1/pos.leverage);
                return { uPnl, roe, liqPrice };
            };

            if (btcPrice === 0) return (
                <div className="min-h-screen flex flex-col items-center justify-center bg-white dark:bg-slate-950 p-6">
                    <div className="w-12 h-12 border-4 border-sky-100 dark:border-slate-800 border-t-sky-500 rounded-full animate-spin"></div>
                    <h1 className="text-sm font-bold text-slate-500 mt-4 tracking-tight text-center">데이터 로딩 중...</h1>
                </div>
            );

            return (
                <div className="min-h-screen bg-slate-50 dark:bg-slate-950 flex flex-col transition-colors duration-300">
                    {/* PnL Modal */}
                    {showPnlCard && (() => {
                        const { uPnl, roe } = getLivePnL(showPnlCard);
                        return (
                            <div className="fixed inset-0 z-[100] flex items-center justify-center bg-slate-900/40 dark:bg-black/60 backdrop-blur-sm p-4">
                                <div className="bg-white dark:bg-slate-900 rounded-[2rem] overflow-hidden shadow-2xl max-w-sm w-full animate-in zoom-in-95 duration-200">
                                    <div className={`p-8 ${showPnlCard.side === 'long' ? 'bg-sky-500' : 'bg-rose-500'} text-white`}>
                                        <div className="flex justify-between items-center mb-12">
                                            <div className="flex items-center gap-2">
                                                <div className="p-1 bg-white/20 rounded-md"><div className="w-4 h-4 bg-white rounded-sm"></div></div>
                                                <span className="font-black tracking-tighter">OXBIT</span>
                                            </div>
                                            <span className="text-[10px] font-black uppercase tracking-widest opacity-80">Trading Card</span>
                                        </div>
                                        <div className="mb-10 text-center">
                                            <div className="text-xs font-bold opacity-70 mb-1">BTCUSDT {showPnlCard.side.toUpperCase()} {showPnlCard.leverage}x</div>
                                            <div className="text-6xl font-black tracking-tighter">{roe >= 0 ? '+' : ''}{roe.toFixed(2)}%</div>
                                        </div>
                                        <div className="grid grid-cols-2 gap-4 border-t border-white/20 pt-6 font-bold text-xs">
                                            <div><div className="opacity-60 mb-1 text-[10px]">Entry Price</div><div>${showPnlCard.entryPrice.toLocaleString()}</div></div>
                                            <div className="text-right"><div className="opacity-60 mb-1 text-[10px]">Market Price</div><div>${btcPrice.toLocaleString()}</div></div>
                                        </div>
                                    </div>
                                    <div className="p-6 flex gap-3">
                                        <button onClick={() => setShowPnlCard(null)} className="flex-1 py-4 bg-slate-100 dark:bg-slate-800 text-slate-900 dark:text-white rounded-2xl font-bold text-xs active:scale-95">이미지 저장</button>
                                        <button onClick={() => setShowPnlCard(null)} className="px-5 py-4 bg-slate-50 dark:bg-slate-800 text-slate-400 rounded-2xl font-bold text-xs"><i data-lucide="x" className="w-4 h-4"></i></button>
                                    </div>
                                </div>
                            </div>
                        );
                    })()}

                    {/* Header */}
                    <header className="sticky top-0 z-50 bg-white/90 dark:bg-slate-900/90 backdrop-blur-md border-b border-slate-100 dark:border-slate-800 px-4 md:px-8 h-14 flex justify-between items-center">
                        <div className="flex items-center gap-8">
                            <OxbitLogo />
                            <nav className="hidden lg:flex items-center gap-6 text-[12px] font-bold text-slate-400 dark:text-slate-500">
                                <a href="#" className="text-sky-500">Trade</a>
                                <a href="#" className="hover:text-slate-600 dark:hover:text-slate-300">Markets</a>
                                <a href="#" className="hover:text-slate-600 dark:hover:text-slate-300">Dashboard</a>
                            </nav>
                        </div>
                        <div className="flex items-center gap-2">
                            <button onClick={() => setIsDark(!isDark)} className="p-2.5 rounded-xl bg-slate-50 dark:bg-slate-800 text-slate-500 dark:text-slate-400 border border-slate-100 dark:border-slate-700 active:scale-95 transition-all">
                                {isDark ? <i data-lucide="sun" className="w-4 h-4"></i> : <i data-lucide="moon" className="w-4 h-4"></i>}
                            </button>
                            <button onClick={() => setIsWalletConnected(!isWalletConnected)} className={`px-4 py-2 rounded-xl font-bold text-[11px] transition-all active:scale-95 flex items-center gap-2 ${isWalletConnected ? 'bg-sky-50 dark:bg-sky-500/10 text-sky-600 dark:text-sky-400 border border-sky-100 dark:border-sky-500/20' : 'bg-sky-500 text-white shadow-lg shadow-sky-100 dark:shadow-none'}`}>
                                <i data-lucide="wallet" className="w-3.5 h-3.5"></i>
                                {isWalletConnected ? '0x71...4f2' : '지갑 연결'}
                            </button>
                        </div>
                    </header>

                    {/* Desktop Ticker */}
                    <div className="hidden md:flex bg-white dark:bg-slate-900 border-b border-slate-100 dark:border-slate-800 px-8 py-2.5 items-center gap-10">
                        <div className="flex items-center gap-2 pr-6 border-r border-slate-100 dark:border-slate-800">
                            <span className="font-bold text-slate-900 dark:text-slate-100 text-xs">BTC/USDT</span>
                            <span className="font-bold text-sky-500 text-xs">${btcPrice.toLocaleString(undefined, { minimumFractionDigits: 1 })}</span>
                            <span className={`text-[10px] font-bold px-1.5 py-0.5 rounded ${priceChange >= 0 ? 'bg-emerald-50 dark:bg-emerald-500/10 text-emerald-500' : 'bg-rose-50 dark:bg-rose-500/10 text-rose-500'}`}>{priceChange >= 0 ? '+' : ''}{priceChange.toFixed(2)}%</span>
                        </div>
                        <div className="flex gap-8 items-center text-[10px] font-bold text-slate-400 dark:text-slate-500 uppercase tracking-tight">
                            <div className="flex gap-2"><span>24h High</span><span className="text-slate-600 dark:text-slate-300">${high24h.toLocaleString()}</span></div>
                            <div className="flex gap-2"><span>24h Low</span><span className="text-slate-600 dark:text-slate-300">${low24h.toLocaleString()}</span></div>
                            <div className="flex gap-2"><span>24h Volume</span><span className="text-slate-600 dark:text-slate-300">${(volume24h/1e6).toFixed(2)}M</span></div>
                        </div>
                    </div>

                    <main className="flex-1 max-w-[1600px] mx-auto w-full p-2 md:p-4 grid grid-cols-12 gap-3 md:gap-4 pb-20 md:pb-4">
                        
                        {/* Left Content */}
                        <div className={`col-span-12 lg:col-span-9 space-y-3 md:space-y-4 ${mobileNav !== 'trade' ? 'hidden md:block' : ''}`}>
                            {/* Chart Container (Set to 1m interval) */}
                            <div className="bg-white dark:bg-slate-900 rounded-2xl border border-slate-100 dark:border-slate-800 overflow-hidden shadow-sm relative chart-container">
                                <iframe id="tv" title="TradingView" src={`https://www.tradingview.com/widgetembed/?symbol=BINANCE:BTCUSDT&interval=1&theme=${isDark ? 'dark' : 'light'}&style=1&timezone=Asia%2FSeoul&locale=kr`} width="100%" height="100%" frameBorder="0" className="absolute inset-0"></iframe>
                            </div>

                            {/* Position List */}
                            <div className="bg-white dark:bg-slate-900 rounded-2xl border border-slate-100 dark:border-slate-800 shadow-sm overflow-hidden">
                                <div className="px-4 md:px-5 border-b border-slate-50 dark:border-slate-800 flex items-center justify-between">
                                    <div className="flex gap-8">
                                        <button className="text-[11px] font-black text-sky-500 border-b-2 border-sky-500 py-4 -mb-px">포지션({positions.length})</button>
                                        <button className="text-[11px] font-black text-slate-400 dark:text-slate-500 py-4">미체결(0)</button>
                                    </div>
                                    <button className="p-1.5 text-slate-300 dark:text-slate-600 hover:bg-slate-50 dark:hover:bg-slate-800 rounded-lg"><i data-lucide="more-horizontal" className="w-4 h-4"></i></button>
                                </div>
                                
                                {positions.length === 0 ? (
                                    <div className="p-12 flex flex-col items-center justify-center text-slate-300 dark:text-slate-700">
                                        <i data-lucide="bar-chart-3" className="w-10 h-10 mb-2 opacity-20"></i>
                                        <p className="text-[11px] font-bold">오픈된 포지션이 없습니다</p>
                                    </div>
                                ) : (
                                    <>
                                        {/* Desktop Table */}
                                        <div className="hidden md:block overflow-x-auto p-2">
                                            <table className="w-full text-left">
                                                <thead>
                                                    <tr className="text-[9px] font-bold text-slate-400 dark:text-slate-500 uppercase tracking-wider border-b border-slate-50 dark:border-slate-800">
                                                        <th className="px-4 py-3">자산/사이드</th>
                                                        <th className="px-4 py-3 text-right">수량</th>
                                                        <th className="px-4 py-3 text-right">진입가</th>
                                                        <th className="px-4 py-3 text-right">청산가</th>
                                                        <th className="px-4 py-3 text-right">미실현 손익</th>
                                                        <th className="px-4 py-3 text-center">액션</th>
                                                    </tr>
                                                </thead>
                                                <tbody className="text-[11px] font-semibold text-slate-600 dark:text-slate-300">
                                                    {positions.map(pos => {
                                                        const { uPnl, roe, liqPrice } = getLivePnL(pos);
                                                        return (
                                                            <tr key={pos.id} className="hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
                                                                <td className="px-4 py-4">
                                                                    <div className="flex items-center gap-1.5">
                                                                        <span className={`font-bold ${pos.side === 'long' ? 'text-emerald-500' : 'text-rose-500'}`}>
                                                                            BTC {pos.side.charAt(0).toUpperCase() + pos.side.slice(1)}
                                                                        </span>
                                                                        <span className={`${pos.side === 'long' ? 'bg-emerald-50 dark:bg-emerald-500/10 text-emerald-600' : 'bg-rose-50 dark:bg-rose-500/10 text-rose-600'} text-[9px] px-1 rounded`}>{pos.leverage}x</span>
                                                                    </div>
                                                                </td>
                                                                <td className="px-4 py-4 text-right font-mono">{pos.size.toFixed(4)} BTC</td>
                                                                <td className="px-4 py-4 text-right font-mono text-slate-400 dark:text-slate-500">${pos.entryPrice.toLocaleString()}</td>
                                                                <td className="px-4 py-4 text-right font-mono text-rose-400">${liqPrice.toLocaleString(undefined, { minimumFractionDigits: 1 })}</td>
                                                                <td className="px-4 py-4 text-right">
                                                                    <div className={`flex flex-col items-end ${uPnl >= 0 ? 'text-emerald-500' : 'text-rose-500'}`}>
                                                                        <span className="font-bold text-[12px]">{uPnl >= 0 ? '+' : ''}{uPnl.toFixed(2)} USDT</span>
                                                                        <span className="text-[10px] font-medium">({roe.toFixed(2)}%)</span>
                                                                    </div>
                                                                </td>
                                                                <td className="px-4 py-4 text-center">
                                                                    <div className="flex justify-center gap-1.5">
                                                                        <button onClick={() => setShowPnlCard(pos)} className="p-1.5 bg-sky-50 dark:bg-sky-500/10 text-sky-500 rounded-lg hover:bg-sky-500 hover:text-white transition-all"><i data-lucide="share-2" className="w-3.5 h-3.5"></i></button>
                                                                        <button onClick={() => closePosition(pos.id)} className="px-3 py-1.5 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 rounded-lg text-[10px] font-bold hover:bg-rose-500 hover:text-white transition-all">종료</button>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        );
                                                    })}
                                                </tbody>
                                            </table>
                                        </div>

                                        {/* Mobile List */}
                                        <div className="md:hidden p-3 space-y-3">
                                            {positions.map(pos => {
                                                const { uPnl, roe, liqPrice } = getLivePnL(pos);
                                                return (
                                                    <div key={pos.id} className="bg-slate-50/50 dark:bg-slate-800/50 rounded-xl p-4 border border-slate-100 dark:border-slate-800">
                                                        <div className="flex justify-between items-center mb-4">
                                                            <div className="flex items-center gap-2">
                                                                <div className={`p-1.5 ${pos.side === 'long' ? 'bg-emerald-50 dark:bg-emerald-500/10' : 'bg-rose-50 dark:bg-rose-500/10'} rounded-lg`}>
                                                                    <i data-lucide={pos.side === 'long' ? "trending-up" : "trending-down"} className={`${pos.side === 'long' ? 'text-emerald-500' : 'text-rose-500'} w-4 h-4`}></i>
                                                                </div>
                                                                <div className="flex flex-col">
                                                                    <span className="font-black text-[11px] text-slate-700 dark:text-slate-200 leading-tight">BTC {pos.side.toUpperCase()} <span className={pos.side === 'long' ? 'text-emerald-500' : 'text-rose-500'}>{pos.leverage}x</span></span>
                                                                    <span className="text-[9px] font-bold text-slate-400 dark:text-slate-500">Cross</span>
                                                                </div>
                                                            </div>
                                                            <div className="text-right">
                                                                <div className={`text-xs font-black ${roe >= 0 ? 'text-emerald-500' : 'text-rose-500'}`}>{roe >= 0 ? '+' : ''}{roe.toFixed(2)}%</div>
                                                                <div className="text-[9px] font-black text-slate-400 dark:text-slate-500">${uPnl.toFixed(2)} USDT</div>
                                                            </div>
                                                        </div>
                                                        <div className="flex justify-between items-center bg-white dark:bg-slate-900 rounded-lg p-2.5 mb-4 border border-slate-100 dark:border-slate-800 text-[10px] font-bold">
                                                            <div className="flex flex-col"><span className="text-slate-300 dark:text-slate-600 text-[9px] uppercase mb-0.5">Entry</span><span className="text-slate-500 dark:text-slate-400">${pos.entryPrice.toLocaleString()}</span></div>
                                                            <div className="flex flex-col text-right"><span className="text-slate-300 dark:text-slate-600 text-[9px] uppercase mb-0.5">Liq. Price</span><span className="text-rose-400">${liqPrice.toLocaleString(undefined, { minimumFractionDigits: 1 })}</span></div>
                                                        </div>
                                                        <div className="flex gap-2">
                                                            <button onClick={() => setShowPnlCard(pos)} className="flex-1 py-2.5 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-400 rounded-lg text-[10px] font-black flex justify-center items-center gap-1.5 active:bg-slate-50 dark:active:bg-slate-700 transition-colors"><i data-lucide="share-2" className="w-3 h-3 text-sky-500"></i> Share</button>
                                                            <button onClick={() => closePosition(pos.id)} className="flex-1 py-2.5 bg-rose-500 text-white rounded-lg text-[10px] font-black shadow-md active:bg-rose-600 transition-colors">Close</button>
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </>
                                )}
                            </div>
                        </div>

                        {/* Right Content */}
                        <div className={`col-span-12 lg:col-span-3 space-y-3 md:space-y-4 ${mobileNav === 'trade' ? 'hidden md:block' : ''}`}>
                            {/* Orderbook */}
                            <div className="bg-white dark:bg-slate-900 rounded-2xl p-4 border border-slate-100 dark:border-slate-800 shadow-sm">
                                <h3 className="text-[10px] font-bold text-slate-400 dark:text-slate-500 uppercase tracking-widest mb-4">Order Book</h3>
                                <div className="space-y-0.5 font-mono text-[10px] font-bold">
                                    {orderBookData.asks.map((item, i) => (
                                        <div key={`a-${i}`} className="flex justify-between items-center py-0.5 transition-colors hover:bg-rose-50/30 dark:hover:bg-rose-500/10"><span className="text-rose-400">{item.price.toLocaleString(undefined, { minimumFractionDigits: 1 })}</span><span className="text-slate-300 dark:text-slate-600">{item.amount}</span></div>
                                    ))}
                                    <div className="py-3 my-2 text-center bg-sky-50 dark:bg-sky-500/10 rounded-lg border border-sky-100 dark:border-sky-500/20">
                                        <div className="text-sm font-bold text-sky-600 dark:text-sky-400">${btcPrice.toLocaleString(undefined, { minimumFractionDigits: 1 })}</div>
                                    </div>
                                    {orderBookData.bids.map((item, i) => (
                                        <div key={`b-${i}`} className="flex justify-between items-center py-0.5 transition-colors hover:bg-emerald-50/30 dark:hover:bg-emerald-500/10"><span className="text-emerald-500">{item.price.toLocaleString(undefined, { minimumFractionDigits: 1 })}</span><span className="text-slate-300 dark:text-slate-600">{item.amount}</span></div>
                                    ))}
                                </div>
                            </div>

                            {/* Trade Panel */}
                            <div className="bg-white dark:bg-slate-900 rounded-2xl p-4 border border-slate-100 dark:border-slate-800 shadow-xl dark:shadow-none md:sticky md:top-20">
                                <div className="flex bg-slate-50 dark:bg-slate-800 p-1 rounded-xl mb-6">
                                    <button onClick={() => setActiveTab('long')} className={`flex-1 py-2 rounded-lg font-bold text-[11px] transition-all ${activeTab === 'long' ? 'bg-sky-500 text-white shadow-md' : 'text-slate-400 dark:text-slate-500'}`}>Long</button>
                                    <button onClick={() => setActiveTab('short')} className={`flex-1 py-2 rounded-lg font-bold text-[11px] transition-all ${activeTab === 'short' ? 'bg-rose-500 text-white shadow-md' : 'text-slate-400 dark:text-slate-500'}`}>Short</button>
                                </div>
                                <div className="space-y-5">
                                    <div>
                                        <div className="flex justify-between text-[10px] font-bold text-slate-400 dark:text-slate-500 mb-2 uppercase tracking-tight">Leverage <span className="text-sky-500">{leverage}x</span></div>
                                        <input type="range" min="1" max="100" value={leverage} onChange={(e) => setLeverage(Number(e.target.value))} className="w-full h-1 bg-slate-100 dark:bg-slate-800 rounded-full appearance-none cursor-pointer mb-2" />
                                    </div>
                                    <div className="bg-slate-50 dark:bg-slate-800 rounded-xl p-3 border border-slate-100 dark:border-slate-700">
                                        <div className="text-[9px] font-bold text-slate-300 dark:text-slate-500 uppercase mb-1">Amount (USDT)</div>
                                        <input 
                                            type="number" 
                                            value={orderAmount}
                                            onChange={(e) => setOrderAmount(e.target.value)}
                                            placeholder="0.00" 
                                            className="bg-transparent text-lg font-bold outline-none w-full placeholder:text-slate-200 dark:text-white" 
                                        />
                                    </div>
                                    <div className="space-y-1.5 text-[10px] font-bold px-1">
                                        <div className="flex justify-between text-slate-400 dark:text-slate-500">
                                            <span>Size (BTC)</span>
                                            <span className="text-slate-600 dark:text-slate-300">
                                                {((parseFloat(orderAmount) || 0) * leverage / btcPrice).toFixed(4)}
                                            </span>
                                        </div>
                                        <div className="flex justify-between text-slate-400 dark:text-slate-500">
                                            <span>Est. Liq Price</span>
                                            <span className="text-rose-400">
                                                ${(activeTab === 'long' ? btcPrice * (1 - 1/leverage) : btcPrice * (1 + 1/leverage)).toLocaleString(undefined, { minimumFractionDigits: 1 })}
                                            </span>
                                        </div>
                                    </div>
                                    <button 
                                        onClick={openPosition}
                                        className={`w-full py-4 ${activeTab === 'long' ? 'bg-sky-500' : 'bg-rose-500'} text-white rounded-xl font-bold text-xs shadow-lg transition-all active:scale-95`}
                                    >
                                        포지션 오픈
                                    </button>
                                    <p className="text-[9px] text-center text-slate-400 dark:text-slate-600 font-bold uppercase tracking-widest">Paper Trading Mode</p>
                                </div>
                            </div>
                        </div>
                    </main>

                    {/* Mobile Navigation */}
                    <nav className="md:hidden fixed bottom-0 left-0 right-0 bg-white dark:bg-slate-900 border-t border-slate-100 dark:border-slate-800 grid grid-cols-4 px-2 py-3 z-50 rounded-t-2xl shadow-lg">
                        <button onClick={() => setMobileNav('trade')} className={`flex flex-col items-center gap-1 ${mobileNav === 'trade' ? 'text-sky-500' : 'text-slate-300 dark:text-slate-600'}`}>
                            <i data-lucide="trending-up" className="w-5 h-5"></i><span className="text-[9px] font-bold uppercase tracking-tighter">Trade</span>
                        </button>
                        <button onClick={() => setMobileNav('info')} className={`flex flex-col items-center gap-1 ${mobileNav === 'info' ? 'text-sky-500' : 'text-slate-300 dark:text-slate-600'}`}>
                            <i data-lucide="bar-chart-3" className="w-5 h-5"></i><span className="text-[9px] font-bold uppercase tracking-tighter">Market</span>
                        </button>
                        <button className="flex flex-col items-center gap-1 text-slate-300 dark:text-slate-600">
                            <i data-lucide="wallet" className="w-5 h-5"></i><span className="text-[9px] font-bold uppercase tracking-tighter">Assets</span>
                        </button>
                        <button className="flex flex-col items-center gap-1 text-slate-300 dark:text-slate-600">
                            <i data-lucide="settings" className="w-5 h-5"></i><span className="text-[9px] font-bold uppercase tracking-tighter">More</span>
                        </button>
                    </nav>

                    {/* Footer Stats */}
                    <footer className="bg-white dark:bg-slate-900 border-t border-slate-100 dark:border-slate-800 py-2 px-8 hidden md:flex justify-between items-center text-[9px] font-bold text-slate-400 dark:text-slate-600 uppercase tracking-widest">
                        <div className="flex items-center gap-4">
                            <div className="flex items-center gap-1.5"><div className="w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse"></div><span>System Live</span></div>
                            <span>Binance Feed: Stable</span>
                        </div>
                        <div className="flex gap-6">
                            <span>{new Date().toLocaleTimeString()} KST</span>
                            <div className="flex items-center gap-1 hover:text-sky-500 cursor-pointer transition-colors"><i data-lucide="info" className="w-3 h-3"></i> API status</div>
                        </div>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
