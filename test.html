<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSX OTT - 프리미엄 스트리밍</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap');
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #05070a;
            color: white;
            -webkit-tap-highlight-color: transparent;
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        .movie-card:active {
            transform: scale(0.95);
        }

        .gradient-overlay {
            background: linear-gradient(to top, rgba(5, 7, 10, 1) 0%, rgba(5, 7, 10, 0.6) 30%, transparent 100%);
        }

        #player-overlay {
            display: none;
            backdrop-filter: blur(12px);
        }
    </style>
</head>
<body class="pb-24">

    <!-- 상단 네비게이션 -->
    <nav class="fixed top-0 w-full z-[100] bg-[#05070a]/80 backdrop-blur-xl px-5 py-4 border-b border-white/5 flex items-center justify-between">
        <div class="flex items-center space-x-2">
            <div class="w-8 h-8 bg-gradient-to-br from-blue-600 to-blue-400 rounded-lg flex items-center justify-center shadow-lg shadow-blue-500/20">
                <i data-lucide="play" class="fill-white text-white w-4 h-4 ml-0.5"></i>
            </div>
            <span class="text-xl font-black italic tracking-tighter uppercase flex items-center">
                SSX<span class="text-blue-500 ml-1">OTT</span>
            </span>
        </div>
        <div class="flex items-center space-x-5">
            <i data-lucide="search" class="w-5 h-5 text-gray-400 cursor-pointer hover:text-white transition-colors"></i>
            <div class="w-8 h-8 rounded-full bg-gradient-to-tr from-gray-800 to-gray-950 border border-white/10 flex items-center justify-center overflow-hidden">
                <i data-lucide="user" class="w-4 h-4 text-gray-400"></i>
            </div>
        </div>
    </nav>

    <!-- 카테고리 탭 -->
    <div id="category-bar" class="pt-20 px-5 overflow-x-auto no-scrollbar flex space-x-2.5 pb-4">
        <!-- JS에서 렌더링 -->
    </div>

    <!-- 메인 배너 -->
    <section class="px-5 mb-10 mt-2">
        <div class="relative aspect-[16/9] rounded-3xl overflow-hidden shadow-2xl group">
            <div class="absolute inset-0 bg-gradient-to-br from-indigo-900 to-black"></div>
            <div class="absolute inset-0 bg-gradient-to-t from-[#05070a] via-black/20 to-transparent z-10"></div>
            <div class="absolute bottom-6 left-6 z-20 space-y-2">
                <div class="flex items-center space-x-2">
                    <span class="px-2 py-0.5 bg-blue-500 text-[10px] font-black rounded uppercase">추천</span>
                    <span class="text-[10px] font-bold text-gray-300 uppercase tracking-widest text-shadow">오늘의 인기 콘텐츠</span>
                </div>
                <h2 class="text-2xl font-black tracking-tight">오징어 게임 시즌 2</h2>
                <p class="text-xs text-gray-400 font-medium max-w-[70%]">기다림은 끝났다. 전 세계가 주목하는 게임이 다시 시작됩니다.</p>
            </div>
            <button onclick="playTrailer('오징어 게임 2')" class="absolute bottom-6 right-6 z-20 w-12 h-12 rounded-full bg-white text-black flex items-center justify-center shadow-xl hover:scale-110 active:scale-95 transition-transform">
                <i data-lucide="play" class="fill-black text-black w-5 h-5 ml-1"></i>
            </button>
        </div>
    </section>

    <!-- 콘텐츠 리스트 섹션 -->
    <section class="px-5 space-y-6">
        <div class="flex justify-between items-center">
            <h3 class="text-lg font-bold flex items-center space-x-2">
                <i data-lucide="flame" class="w-5 h-5 text-orange-500"></i>
                <span>지금 뜨는 예고편</span>
            </h3>
            <button class="text-[11px] font-bold text-gray-500 flex items-center">
                더보기 <i data-lucide="chevron-right" class="w-4 h-4"></i>
            </button>
        </div>

        <div id="movie-grid" class="grid grid-cols-2 sm:grid-cols-3 gap-4">
            <!-- JS에서 렌더링 -->
        </div>
    </section>

    <!-- 하단 네비게이션 바 -->
    <div class="fixed bottom-0 w-full bg-[#05070a]/95 backdrop-blur-2xl border-t border-white/5 px-8 py-4 flex justify-between items-center z-[100] pb-8">
        <div class="flex flex-col items-center space-y-1.5 text-blue-500">
            <i data-lucide="home" class="w-6 h-6"></i>
            <span class="text-[10px] font-bold">홈</span>
        </div>
        <div class="flex flex-col items-center space-y-1.5 text-gray-500">
            <i data-lucide="tv" class="w-6 h-6"></i>
            <span class="text-[10px] font-bold">드라마</span>
        </div>
        <div class="flex flex-col items-center space-y-1.5 text-gray-500">
            <i data-lucide="film" class="w-6 h-6"></i>
            <span class="text-[10px] font-bold">영화</span>
        </div>
        <div class="flex flex-col items-center space-y-1.5 text-gray-500">
            <i data-lucide="heart" class="w-6 h-6"></i>
            <span class="text-[10px] font-bold">찜</span>
        </div>
        <div class="flex flex-col items-center space-y-1.5 text-gray-500">
            <i data-lucide="user" class="w-6 h-6"></i>
            <span class="text-[10px] font-bold">마이</span>
        </div>
    </div>

    <!-- 플레이어 오버레이 -->
    <div id="player-overlay" class="fixed inset-0 z-[200] bg-black/95 flex flex-col items-center justify-center p-4">
        <div class="w-full max-w-4xl relative">
            <button onclick="closePlayer()" class="absolute -top-12 right-0 w-10 h-10 rounded-full bg-white/10 flex items-center justify-center text-white hover:bg-white/20 transition-colors">
                <i data-lucide="x" class="w-6 h-6"></i>
            </button>
            <div id="youtube-container" class="aspect-video bg-zinc-900 rounded-2xl overflow-hidden shadow-2xl border border-white/5">
                <!-- iframe 삽입 위치 -->
            </div>
            <div id="movie-details" class="mt-6 space-y-4">
                <!-- 동적 텍스트 -->
            </div>
        </div>
    </div>

    <script>
        const apiKey = ""; // Gemini API 키
        const categories = ['전체', '드라마', '영화', '예능', '애니'];
        let movies = [];
        let activeCategory = '전체';

        // 루사이드 아이콘 초기화
        function initIcons() {
            lucide.createIcons();
        }

        // Gemini API로 트렌드 데이터 가져오기
        async function fetchTrending() {
            const movieGrid = document.getElementById('movie-grid');
            movieGrid.innerHTML = Array(6).fill(0).map(() => `
                <div class="aspect-[2/3] bg-white/5 rounded-2xl animate-pulse"></div>
            `).join('');

            try {
                const prompt = `2024년 말부터 2025년까지 대한민국에서 유행하는 드라마, 영화, 예능 목록 20개를 작성해줘. 
                JSON 형식으로 반환해: { "contents": [{ "title": "제목", "type": "드라마/영화/예능/애니", "year": "2025", "rating": "9.8", "summary": "작품에 대한 짧은 한국어 소개글" }] }`;
                
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }],
                        generationConfig: { responseMimeType: "application/json" }
                    })
                });

                const data = await response.json();
                const rawData = JSON.parse(data.candidates[0].content.parts[0].text);
                movies = rawData.contents.map((item, idx) => ({
                    ...item,
                    id: idx,
                    gradient: ['from-blue-600/40', 'from-indigo-600/40', 'from-rose-600/40', 'from-cyan-600/40'][idx % 4],
                    isOriginal: idx % 4 === 0
                }));
                renderMovies();
            } catch (error) {
                console.error("데이터 로드 실패", error);
                movieGrid.innerHTML = `<div class="col-span-2 py-10 text-center text-gray-500">데이터를 불러오지 못했습니다.</div>`;
            }
        }

        // 영화 리스트 렌더링
        function renderMovies() {
            const movieGrid = document.getElementById('movie-grid');
            const filtered = activeCategory === '전체' ? movies : movies.filter(m => m.type === activeCategory);
            
            movieGrid.innerHTML = filtered.map(movie => `
                <div onclick="playTrailer('${movie.title}')" class="movie-card relative aspect-[2/3] rounded-2xl overflow-hidden bg-[#12161f] cursor-pointer group transition-all duration-300">
                    <div class="absolute inset-0 bg-gradient-to-br ${movie.gradient} to-transparent opacity-60"></div>
                    ${movie.isOriginal ? '<div class="absolute top-3 left-3 bg-blue-600/90 backdrop-blur-md text-[9px] font-black px-2 py-0.5 rounded shadow-lg z-20 border border-white/10 text-white">SSX 오리지널</div>' : ''}
                    <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                        <i data-lucide="play" class="w-10 h-10 fill-white text-white"></i>
                    </div>
                    <div class="absolute bottom-0 left-0 w-full p-4 bg-gradient-to-t from-black via-black/60 to-transparent">
                        <h4 class="text-[13px] font-bold truncate mb-1">${movie.title}</h4>
                        <div class="flex items-center justify-between text-[10px]">
                            <span class="text-blue-400 font-bold">공식 예고편</span>
                            <span class="text-yellow-400 font-black">★ ${movie.rating}</span>
                        </div>
                    </div>
                </div>
            `).join('');
            initIcons();
        }

        // 카테고리 바 렌더링
        function renderCategories() {
            const container = document.getElementById('category-bar');
            container.innerHTML = categories.map(cat => `
                <button onclick="setCategory('${cat}')" class="px-5 py-2 rounded-xl text-xs font-bold flex-shrink-0 transition-all duration-300 border ${
                    activeCategory === cat 
                    ? 'bg-blue-600 border-blue-500 text-white shadow-lg shadow-blue-600/20 scale-105' 
                    : 'bg-white/5 border-white/5 text-gray-400 hover:bg-white/10'
                }">${cat}</button>
            `).join('');
        }

        function setCategory(cat) {
            activeCategory = cat;
            renderCategories();
            renderMovies();
        }

        // 예고편 재생 로직 (Gemini 활용하여 유튜브 ID 찾기)
        async function playTrailer(title) {
            const overlay = document.getElementById('player-overlay');
            const container = document.getElementById('youtube-container');
            const details = document.getElementById('movie-details');
            
            const movie = movies.find(m => m.title === title) || { title, year: "2025", summary: "SSX OTT가 추천하는 최신 기대작입니다." };

            overlay.style.display = 'flex';
            container.innerHTML = `
                <div class="absolute inset-0 flex flex-col items-center justify-center space-y-4">
                    <div class="w-10 h-10 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"></div>
                    <p class="text-xs font-bold text-gray-500">예고편 검색 중...</p>
                </div>
            `;
            details.innerHTML = `
                <div class="flex items-center justify-between">
                    <div>
                        <h2 class="text-2xl font-black">${movie.title}</h2>
                        <p class="text-sm text-blue-500 font-bold">${movie.year} • 공식 예고편</p>
                    </div>
                </div>
                <p class="text-sm text-gray-400 leading-relaxed font-medium">${movie.summary}</p>
                <button class="w-full py-4 bg-blue-600 text-white rounded-2xl font-black text-lg shadow-xl shadow-blue-600/30">지금 감상하기</button>
            `;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: `Search Google and find the YouTube video ID for the official Korean trailer of "${title}". Return ONLY the 11-character video ID.` }] }],
                        tools: [{ google_search: {} }]
                    })
                });
                const data = await response.json();
                const text = data.candidates?.[0]?.content?.parts?.[0]?.text || "";
                const match = text.match(/[a-zA-Z0-9_-]{11}/);
                const videoId = match ? match[0] : "dQw4w9WgXcQ";

                container.innerHTML = `
                    <iframe width="100%" height="100%" 
                        src="https://www.youtube.com/embed/${videoId}?autoplay=1&modestbranding=1&rel=0&hl=ko" 
                        frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
                    </iframe>
                `;
            } catch (error) {
                container.innerHTML = `<div class="absolute inset-0 flex items-center justify-center text-gray-500">영상을 찾을 수 없습니다.</div>`;
            }
        }

        function closePlayer() {
            const overlay = document.getElementById('player-overlay');
            const container = document.getElementById('youtube-container');
            overlay.style.display = 'none';
            container.innerHTML = ''; // iframe 중지
        }

        // 초기화 실행
        window.onload = () => {
            renderCategories();
            fetchTrending();
            initIcons();
        };
    </script>
</body>
</html>

