<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>리나닷컴 대시보드 | 로컬 관리 시스템</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=JetBrains_Mono:wght@400;700&display=swap');

        :root {
            --bg-deep: #0f0a1e;
            --brand-primary: #a855f7;
            --text-main: #f5f3ff;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: var(--bg-deep);
            color: var(--text-main);
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        .bg-mesh {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: 
                radial-gradient(circle at 10% 10%, rgba(168, 85, 247, 0.1) 0%, transparent 40%),
                radial-gradient(circle at 90% 90%, rgba(139, 92, 246, 0.08) 0%, transparent 40%);
            z-index: -1;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 24px;
        }

        .admin-section {
            background: rgba(168, 85, 247, 0.05);
            border: 1px dashed rgba(168, 85, 247, 0.3);
            border-radius: 24px;
        }

        .stat-value {
            font-family: 'JetBrains_Mono', monospace;
            letter-spacing: -0.05em;
        }

        .sidebar-item.active {
            background: rgba(168, 85, 247, 0.15);
            border-left: 3px solid #a855f7;
            color: #d8b4fe;
        }

        .input-dark {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 10px 14px;
            color: white;
            font-size: 13px;
            outline: none;
            width: 100%;
            transition: all 0.2s;
        }

        .input-dark:focus {
            border-color: #a855f7;
            background: rgba(168, 85, 247, 0.1);
        }

        .btn-save {
            background: #a855f7;
            color: white;
            font-weight: 700;
            padding: 12px;
            border-radius: 12px;
            transition: all 0.2s;
            cursor: pointer;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-save:hover { background: #9333ea; transform: translateY(-2px); box-shadow: 0 4px 15px rgba(168, 85, 247, 0.4); }

        #toast {
            visibility: hidden;
            min-width: 250px;
            background-color: #a855f7;
            color: #fff;
            text-align: center;
            border-radius: 12px;
            padding: 16px;
            position: fixed;
            z-index: 100;
            right: 30px;
            bottom: 30px;
            font-weight: bold;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        #toast.show {
            visibility: visible;
            animation: fadein 0.5s, fadeout 0.5s 2.5s;
        }

        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 200;
        }
        .modal-content {
            background: #1a142e;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            padding: 30px;
        }

        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
        @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }

        @media (max-width: 1024px) {
            .sidebar { transform: translateX(-100%); transition: transform 0.3s ease; }
            .sidebar.open { transform: translateX(0); }
        }
    </style>
</head>
<body class="min-h-screen flex">
    <div class="bg-mesh"></div>
    <div id="toast">설정이 브라우저에 저장되었습니다!</div>

    <!-- Asset Selection Modal -->
    <div id="asset-modal" class="modal-overlay" onclick="closeAssetModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h3 class="text-xl font-bold text-white">로고 이미지 선택</h3>
                    <p class="text-[10px] text-white/40 mt-1">저장된 자산 또는 외부 URL을 사용하세요.</p>
                </div>
                <button onclick="document.getElementById('asset-modal').style.display='none'" class="text-white/40 hover:text-white transition-colors p-2"><i class="fas fa-times"></i></button>
            </div>
            <div id="asset-list" class="grid grid-cols-2 sm:grid-cols-3 gap-4">
                <!-- Preset items -->
                <div onclick="selectLogo('https://raw.githubusercontent.com/talmobottle1-boop/newtank26/main/assets/images/binance.png')" class="bg-white/5 border border-white/10 rounded-xl p-4 cursor-pointer hover:border-purple-500 hover:bg-white/10 transition-all flex flex-col items-center gap-3">
                    <img src="https://raw.githubusercontent.com/talmobottle1-boop/newtank26/main/assets/images/binance.png" class="h-10 object-contain">
                    <span class="text-[10px] text-white/50">Binance</span>
                </div>
                <div onclick="selectLogo('https://raw.githubusercontent.com/talmobottle1-boop/newtank26/main/assets/images/bitget.png')" class="bg-white/5 border border-white/10 rounded-xl p-4 cursor-pointer hover:border-purple-500 hover:bg-white/10 transition-all flex flex-col items-center gap-3">
                    <img src="https://raw.githubusercontent.com/talmobottle1-boop/newtank26/main/assets/images/bitget.png" class="h-10 object-contain">
                    <span class="text-[10px] text-white/50">Bitget</span>
                </div>
                <!-- Add more presets as needed -->
            </div>
            <div class="mt-6 pt-6 border-t border-white/10">
                <label class="text-[11px] text-white/50 mb-2 block font-bold">직접 URL 입력</label>
                <div class="flex gap-2">
                    <input type="text" id="custom-logo-url" class="input-dark" placeholder="https://example.com/logo.png">
                    <button onclick="selectLogo(document.getElementById('custom-logo-url').value)" class="bg-purple-500 px-4 rounded-xl text-xs font-bold">적용</button>
                </div>
            </div>
        </div>
    </div>

    <aside id="sidebar" class="sidebar fixed inset-y-0 left-0 w-64 bg-[#0a0515]/90 border-r border-white/5 z-50 lg:static lg:transform-none">
        <div class="p-6">
            <div class="flex items-center space-x-2.5 mb-10 cursor-pointer" onclick="location.href='index.html'">
                <div class="w-8 h-8 rounded-xl bg-gradient-to-br from-purple-500 to-purple-800 flex items-center justify-center shadow-lg">
                    <i class="fas fa-infinity text-white text-xs"></i>
                </div>
                <span class="text-lg font-bold italic tracking-tighter text-white">리나<span class="text-purple-500">닷컴</span></span>
            </div>

            <nav class="space-y-1">
                <a href="#summary" class="sidebar-item active flex items-center space-x-3 px-4 py-3.5 rounded-xl text-sm font-medium transition-all">
                    <i class="fas fa-th-large w-5"></i>
                    <span>종합 현황</span>
                </a>
                <a href="#admin-home" class="sidebar-item flex items-center space-x-3 px-4 py-3.5 rounded-xl text-sm font-medium text-white/40 hover:text-white transition-all">
                    <i class="fas fa-tools w-5"></i>
                    <span>홈페이지 관리</span>
                </a>
                <a href="#admin-exchange" class="sidebar-item flex items-center space-x-3 px-4 py-3.5 rounded-xl text-sm font-medium text-white/40 hover:text-white transition-all">
                    <i class="fas fa-list w-5"></i>
                    <span>거래소 목록 관리</span>
                </a>
            </nav>
        </div>
    </aside>

    <main class="flex-1 flex flex-col min-w-0">
        <header class="h-16 border-b border-white/5 flex items-center justify-between px-6 lg:px-10 bg-[#0f0a1e]/50 backdrop-blur-md sticky top-0 z-40">
            <div class="flex items-center">
                <button onclick="toggleSidebar()" class="lg:hidden text-white mr-4"><i class="fas fa-bars"></i></button>
                <h1 class="text-sm font-bold text-white/80 uppercase tracking-widest">Admin Control Panel</h1>
            </div>
            <div class="flex items-center space-x-4">
                <span class="text-[10px] bg-emerald-500/20 text-emerald-400 px-2 py-1 rounded font-bold border border-emerald-500/30">LOCAL STORAGE MODE</span>
            </div>
        </header>

        <div class="p-6 lg:p-10 space-y-12 max-w-7xl mx-auto w-full">
            <!-- Stats Summary -->
            <section id="summary" class="grid grid-cols-1 md:grid-cols-3 gap-6 pt-4">
                <div class="glass-card p-6 border-l-4 border-l-purple-500">
                    <p class="text-[11px] font-bold text-white/40 uppercase tracking-widest mb-2">총 환급액 관리</p>
                    <div class="flex items-baseline space-x-2">
                        <span id="stat-total" class="text-3xl font-bold stat-value text-white">12,450.50</span>
                        <span class="text-xs font-bold text-purple-400">USDT</span>
                    </div>
                </div>
                <div class="glass-card p-6">
                    <p class="text-[11px] font-bold text-white/40 uppercase tracking-widest mb-2">활성 연결 유저</p>
                    <div class="flex items-baseline space-x-2">
                        <span id="stat-users" class="text-3xl font-bold stat-value text-white">1,204</span>
                        <span class="text-xs font-bold text-emerald-400">명</span>
                    </div>
                </div>
                <div class="glass-card p-6">
                    <p class="text-[11px] font-bold text-white/40 uppercase tracking-widest mb-2">미처리 출금</p>
                    <div class="flex items-baseline space-x-2">
                        <span id="stat-withdraws" class="text-3xl font-bold stat-value text-white">3</span>
                        <span class="text-xs font-bold text-purple-400">건</span>
                    </div>
                </div>
            </section>

            <hr class="border-white/5">

            <!-- Home Settings -->
            <section id="admin-home" class="admin-section p-8 space-y-8">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 rounded-full bg-purple-500 flex items-center justify-center shadow-[0_0_15px_rgba(168,85,247,0.5)]"><i class="fas fa-bullhorn text-white"></i></div>
                    <h2 class="text-xl font-bold">상단 팝업 및 메인 헤더 설정</h2>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="space-y-4">
                        <h3 class="text-xs font-black text-purple-400 uppercase tracking-widest">팝업 문구 및 버튼</h3>
                        <div class="space-y-3">
                            <label class="text-[11px] text-white/50">메인 팝업 텍스트</label>
                            <input type="text" id="top-popup-text" class="input-dark" placeholder="팝업 문구 입력">
                            <div class="grid grid-cols-2 gap-3">
                                <div><label class="text-[11px] text-white/50">거래소 버튼명</label><input type="text" id="top-popup-exchange" class="input-dark"></div>
                                <div><label class="text-[11px] text-white/50">액션 버튼명</label><input type="text" id="top-popup-action" class="input-dark"></div>
                            </div>
                            <div class="flex items-center space-x-2 pt-2">
                                <input type="checkbox" id="top-popup-hide" class="w-4 h-4 rounded bg-white/5 border-white/10 accent-purple-500">
                                <label for="top-popup-hide" class="text-xs text-red-400 font-bold">상단 팝업 숨기기</label>
                            </div>
                        </div>
                    </div>
                    <div class="space-y-4">
                        <h3 class="text-xs font-black text-purple-400 uppercase tracking-widest">환급액 테스트 거래소 목록</h3>
                        <div class="space-y-3">
                            <label class="text-[11px] text-white/50">계산기에 표시될 거래소 (콤마로 구분)</label>
                            <textarea id="calc-exchanges" class="input-dark h-24" placeholder="Binance, Bitget..."></textarea>
                        </div>
                    </div>
                </div>
                <button onclick="saveSettings()" class="btn-save w-full md:w-auto px-10">설정 저장하기</button>
            </section>

            <!-- Exchange List Settings -->
            <section id="admin-exchange" class="glass-card p-8 space-y-8">
                <div class="flex justify-between items-center">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 rounded-full bg-indigo-500 flex items-center justify-center shadow-[0_0_15px_rgba(99,102,241,0.5)]"><i class="fas fa-university text-white"></i></div>
                        <h2 class="text-xl font-bold">제휴 거래소 상세 관리</h2>
                    </div>
                    <button onclick="addExchangeRow()" class="px-4 py-2 bg-white/5 border border-white/10 rounded-xl text-xs font-bold hover:bg-white/10 transition-all">+ 거래소 추가</button>
                </div>
                <div id="exchange-list" class="space-y-6"></div>
                <button onclick="saveSettings()" class="btn-save w-full">거래소 목록 전체 업데이트</button>
            </section>
        </div>

        <footer class="mt-auto py-10 px-6 border-t border-white/5 text-center">
            <p class="text-[10px] text-white/20 uppercase tracking-[0.2em] font-medium">LinaDotCom Admin Control System © 2025</p>
        </footer>
    </main>

    <script>
        let currentEditingIndex = -1;
        let config = {
            home: {
                topText: "지금 바이낸스 페이백 원해?",
                topExchange: "바이낸스",
                topAction: "지금 연결",
                topHide: false,
                calcExchanges: "Binance, Bitget, Bybit, OKX, Deepcoin, Mexc"
            },
            exchanges: [
                { id: 1, name: '비트겟 (Bitget)', rate: 81, color: 'from-[#00f0ff]/20', logo: 'https://raw.githubusercontent.com/talmobottle1-boop/newtank26/main/assets/images/bitget.png', link: '#' },
                { id: 2, name: '바이낸스 (Binance)', rate: 30, color: 'from-[#f3ba2f]/20', logo: 'https://raw.githubusercontent.com/talmobottle1-boop/newtank26/main/assets/images/binance.png', link: '#' }
            ]
        };

        window.onload = function() {
            const saved = localStorage.getItem('lina_config');
            if (saved) config = JSON.parse(saved);
            syncUI();
        };

        function syncUI() {
            document.getElementById('top-popup-text').value = config.home.topText;
            document.getElementById('top-popup-exchange').value = config.home.topExchange;
            document.getElementById('top-popup-action').value = config.home.topAction;
            document.getElementById('top-popup-hide').checked = config.home.topHide;
            document.getElementById('calc-exchanges').value = config.home.calcExchanges;
            renderExchanges();
        }

        function renderExchanges() {
            const container = document.getElementById('exchange-list');
            container.innerHTML = '';
            config.exchanges.forEach((ex, index) => {
                const row = document.createElement('div');
                row.className = "p-6 bg-white/2 border border-white/5 rounded-2xl space-y-6 relative group hover:border-indigo-500/30 transition-all";
                row.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex items-center space-x-4">
                            <div class="w-10 h-10 bg-white/10 rounded p-2 flex items-center justify-center overflow-hidden">
                                <img id="preview-${index}" src="${ex.logo}" class="max-h-full">
                            </div>
                            <input type="text" class="bg-transparent border-none text-white font-bold text-lg outline-none focus:ring-1 focus:ring-indigo-500 rounded px-1" value="${ex.name}" onchange="updateExData(${index}, 'name', this.value)">
                        </div>
                        <button onclick="deleteExchange(${index})" class="text-red-400 text-xs font-bold hover:text-red-300 transition-colors"><i class="fas fa-trash-alt mr-1"></i> 삭제</button>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div><label class="text-[10px] text-white/40 block mb-1 uppercase font-bold">페이백 요율 (%)</label><input type="number" class="input-dark" value="${ex.rate}" onchange="updateExData(${index}, 'rate', parseInt(this.value))"></div>
                        <div><label class="text-[10px] text-white/40 block mb-1 uppercase font-bold">배경색 (Tailwind)</label><input type="text" class="input-dark" value="${ex.color}" onchange="updateExData(${index}, 'color', this.value)"></div>
                        <div>
                            <label class="text-[10px] text-white/40 block mb-1 uppercase font-bold">로고 설정</label>
                            <button onclick="openAssetModal(${index})" class="w-full px-3 py-2 bg-purple-500/20 border border-purple-500/40 rounded-xl text-[10px] font-bold text-purple-300 hover:bg-purple-500/40 transition-all">이미지 선택/변경</button>
                        </div>
                    </div>
                    <div><label class="text-[10px] text-white/40 block mb-1 uppercase font-bold">연결하기 링크</label><input type="text" class="input-dark" value="${ex.link}" onchange="updateExData(${index}, 'link', this.value)"></div>
                `;
                container.appendChild(row);
            });
        }

        function openAssetModal(index) {
            currentEditingIndex = index;
            document.getElementById('asset-modal').style.display = 'flex';
        }

        function selectLogo(url) {
            if (!url) return;
            updateExData(currentEditingIndex, 'logo', url);
            document.getElementById(`preview-${currentEditingIndex}`).src = url;
            document.getElementById('asset-modal').style.display = 'none';
            document.getElementById('custom-logo-url').value = '';
        }

        function updateExData(index, key, value) {
            config.exchanges[index][key] = value;
        }

        function addExchangeRow() {
            config.exchanges.push({ id: Date.now(), name: '새 거래소', rate: 50, color: 'from-purple-500/20', logo: 'https://via.placeholder.com/100', link: '#' });
            renderExchanges();
        }

        function deleteExchange(index) {
            if (confirm('정말 삭제하시겠습니까?')) {
                config.exchanges.splice(index, 1);
                renderExchanges();
            }
        }

        function saveSettings() {
            config.home.topText = document.getElementById('top-popup-text').value;
            config.home.topExchange = document.getElementById('top-popup-exchange').value;
            config.home.topAction = document.getElementById('top-popup-action').value;
            config.home.topHide = document.getElementById('top-popup-hide').checked;
            config.home.calcExchanges = document.getElementById('calc-exchanges').value;

            localStorage.setItem('lina_config', JSON.stringify(config));
            showToast("설정이 성공적으로 저장되었습니다!");
        }

        function showToast(msg) {
            const toast = document.getElementById("toast");
            toast.innerText = msg;
            toast.className = "show";
            setTimeout(() => { toast.className = ""; }, 3000);
        }

        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('open'); }
        function closeAssetModal(e) { if (e.target.id === 'asset-modal') document.getElementById('asset-modal').style.display = 'none'; }
    </script>
</body>
</html>
